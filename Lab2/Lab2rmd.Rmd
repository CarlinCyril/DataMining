---
title: "Lab 2"
author: "Blanco Romain, Carlin Cyril, Dong St√©phane"
date: ''
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## 1 Data :

```{r}
NAm2 = read.table("NAm2.txt", header = TRUE)
names=unique(NAm2$Pop)
npop=length(names)
coord=unique(NAm2[,c("Pop","long","lat")]) #coordinates for each pop
colPalette=rep(c("black","red","cyan","orange","brown","blue","pink","purple","darkgreen"),3)
pch=rep(c(16,15,25),each=9)
plot(coord[,c("long","lat")],pch=pch,col=colPalette,asp=1)
# asp allows to have the correct ratio between axis longitude and latitude
# Then the map is not deformed
legend("bottomleft",legend=names,col=colPalette,lty=-1,pch=pch,cex=.75,ncol=2,lwd=2)
library(maps);map("world",add=T)

```

This script displays on map each individual thanks to the latitude and the longitude. First of all, the data table is grouped by population thanks to the function <I> unique() </I> then the latitude and longitude are recuperated and there are the coordinates for each population. Finally, a <I> plot() </I> and the package maps display the result. 


## 2 Regression :


```{r}
sink(file = "Res.txt")
NAm2 = read.table("NAm2.txt", header = TRUE)
NAaux = NAm2[,-c(1:7)]

dataframe = data.frame(NAaux)

regression = lm(long ~ .,data = dataframe)


```


```{r, include=FALSE}
summary(regression)
sink()

```

The summary is visible in the file Res.txt. We can see in this file line like this :

L2.264                   -3.5460         NA      NA       NA


The linear regression model doesn't work because t-values and p-value aren't calculable, there are NA instead of figures in the summary. That's due to the fact that the number of observations (samples $n=494$) is lower than the number of variables (markers $p=5709$ ).




## 3 PCA :

## a) 

The PCA is a method which transforms correlated variables in uncorrelated variables. These new variables are called principal components. That allows to synthesize the information and eliminate the useless information. 



## b)
```{r}
pcaNAm2 <- prcomp(NAm2[,9:length(NAm2)])
```
Since the datas are all ones and zeros (same unit), we do not need to use the argument scale of prcomp.


## c)
```{r}
caxes=c(1,2) # c(5,6) for the 5th and 6th axes
plot(pcaNAm2$x[,caxes],col="white")
for (i in 1:npop) {
  lines(pcaNAm2$x[which(NAm2[,3]==names[i]),caxes], type="p",col=colPalette[i],pch=pch[i])
}
legend("bottomleft",legend=names,col=colPalette,lty=- 1,pch=pch,cex=.5,ncol=3,lwd=2)
```
\
The graph represents the influence that some genetic markers have on the populations.\
A lot of populations are very close to each other.\
However, some of them are quite distinguishable, for example :\ 
Axes 1 and 2 : Ache and Surui\
Axes 5 and 6 : Pima and Karitiana\


## d)
The first 2 principal components capture 3.568 % of the variance ("summary(pcaNAm2)").\
In order to represent genetic markers efficiently using a minimal number of principal components, we need the components to have at least a cumulative proportion of the variance of around 60-70 %.\
With the results that we have, we would choose to keep the first 200 principal components (68.217%).\


## 4 PCR


## a)

